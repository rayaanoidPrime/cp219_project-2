# Project configuration
project:
  name: "cp219-goose-ids"
  entity: "HPR-cp219" # W&B team name

data:
  raw_dir: "data/raw"
  processed_dir: "data/processed"
  train_files:
    replay: "replay_labelled_train.csv"
    masquerade: "masquerade_labelled_train.csv"
    injection: "injection_labelled_train.csv"
    poisoning: "poisoning_labelled_train.csv"
  test_files:
    replay: "replay_labelled_test.csv"
    masquerade: "masquerade_labelled_test.csv"
    injection: "injection_labelled_test.csv"
    poisoning: "poisoning_labelled_test.csv"

preprocessing:
  group_by_gocbref: true
  handle_missing: "drop" # or "impute"
  scaling: "standard" # or "minmax", "robust"

feature_engineering:
  temporal_features: true
  statistical_features: true
  custom_features: true

# New: Dimensionality reduction pipeline
dimensionality_reduction:
  enabled: true
  method: "autoencoder,umap" # or "autoencoder", "umap", "pca"
  
  autoencoder:
    enabled: true
    architecture:
      encoder_layers: [128, 64, 32]  # Hidden layer sizes
      latent_dim: 16  # Bottleneck dimension
      decoder_layers: [32, 64, 128]  # Mirror of encoder
    training:
      epochs: 100
      batch_size: 256
      learning_rate: 0.001
      early_stopping_patience: 10
      validation_split: 0.2
    activation: "relu"  # or "tanh", "leaky_relu"
    dropout: 0.2
    save_model: true
  
  umap:
    enabled: true
    n_components: 2  # For visualization (use 3-10 for clustering)
    n_neighbors: 15  # Local neighborhood size (5-50)
    min_dist: 0.1  # Minimum distance in embedding (0.0-0.99)
    metric: "euclidean"  # or "cosine", "manhattan"
    random_state: 42
    use_autoencoder_output: true  # Apply UMAP to autoencoder latent space

# New: Clustering configuration
clustering:
  enabled: true
  methods:
    kmeans:
      enabled: true
      n_clusters: 5  # Or "auto" to determine automatically
      n_init: 10
      max_iter: 300
      random_state: 42
    
    dbscan:
      enabled: true
      eps: 0.5  # Maximum distance between samples
      min_samples: 5  # Minimum samples in neighborhood
      metric: "euclidean"
    
    hdbscan:
      enabled: true
      min_cluster_size: 50  # Minimum cluster size
      min_samples: 5
      cluster_selection_epsilon: 0.0
      metric: "euclidean"
    
    hierarchical:
      enabled: false
      n_clusters: 5
      linkage: "ward"  # or "complete", "average"
  
  # Apply clustering to which representation?
  input_source: "umap"  # "autoencoder", "umap", or "original"
  
  # Cluster evaluation
  evaluate_clusters: true
  metrics:
    - silhouette_score
    - calinski_harabasz_score
    - davies_bouldin_score

# Visualization
visualization:
  save_plots: true
  plots_dir: "outputs/plots"
  
  umap_plots:
    - scatter_by_label  # Color by true labels
    - scatter_by_cluster  # Color by predicted clusters
    - interactive_3d  # If n_components >= 3
  
  autoencoder_plots:
    - reconstruction_error
    - latent_space_distribution
    - training_loss

evaluation:
  metrics:
    - accuracy
    - precision
    - recall
    - f1_score
    - confusion_matrix
  cross_validation: false
  
  # Cluster-based anomaly detection
  anomaly_detection:
    enabled: true
    method: "isolation_forest"  # or "reconstruction_error", "cluster_distance"
    contamination: 0.1  # Expected proportion of outliers

wandb:
  enabled: true
  log_frequency: 10
  save_checkpoints: true
  log_embeddings: true  # Log UMAP/autoencoder projections
  log_cluster_metrics: true